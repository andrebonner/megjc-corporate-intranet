!function(){function t(t,e){t.otherwise({redirectTo:"/login"})}function e(t,e,n){t.$on("$routeChangeStart",function(t,r,o){r.access.restricted&&!n.isAuthenticated()&&e.path("/login")})}e.$inject=["$rootScope","$location","loginService"],t.$inject=["$routeProvider","$httpProvider"],angular.module("intranet",["ngRoute","ngCookies","home","dashboard","directory","login","help","shared-services","vacancy","promotion","mail","nav"]).run(e).config(t).constant("API_URLS",{base_url:"/api/v1/"})}(),function(){"use strict";function t(t){t.when("/dashboard/apps",{templateUrl:"public/app/modules/dashboard/dashboard.html",controller:"Dashboard as vm",access:{restricted:!0}}).otherwise({redirectTo:"/"})}t.$inject=["$routeProvider"],angular.module("dashboard",[]).config(t)}(),function(){"use strict";function t(){return function(t){return new Date(t)}}function e(){return function(t){var e=t/1048576;return e.toFixed(2)}}function n(t){return function(e){return t.trustAsHtml(e)}}function r(){return function(t){var e=/&(nbsp|amp|quot|lt|gt);/g,n={nbsp:" ",amp:"&",quot:'"',lt:"<",gt:">"};return t.replace(e,function(t,e){return n[e]})}}n.$inject=["$sce"],angular.module("intranet").filter("sanitize",n).filter("removeEntities",r).filter("timestamp",t).filter("toMB",e)}(),function(){function t(t){t.when("/directory",{controller:"Directory",controllerAs:"vm",templateUrl:"public/app/modules/directory/directory.html"})}t.$inject=["$routeProvider"],angular.module("directory",[]).config(t)}(),function(){function t(t){t.when("/help-desk",{templateUrl:"public/app/modules/help-desk/help.html",controller:"HelpDesk",controllerAs:"vm",access:{restricted:!1}})}t.$inject=["$routeProvider"],angular.module("help",[]).config(t)}(),function(){function t(t){t.when("/",{controller:"Home",controllerAs:"vm",templateUrl:"public/app/modules/home/home.html",access:{restricted:!1}}).when("/news-feed",{controller:"Home",controllerAs:"vm",templateUrl:"public/app/modules/home/news-feed.html",access:{restricted:!1}})}t.$inject=["$routeProvider"],angular.module("home",[]).config(t)}(),function(){function t(t){t.when("/login",{controller:"Login",controllerAs:"vm",templateUrl:"public/app/modules/login/login.html",access:{restricted:!1}})}t.$inject=["$routeProvider"],angular.module("login",[]).config(t)}(),function(){"use strict";angular.module("nav",[])}(),function(){function t(t){t.when("/dashboard/apps/mails",{templateUrl:"public/app/modules/mail/mail.html",controller:"Mail",access:{restricted:!0}}).when("/dashboard/apps/mails/create",{templateUrl:"public/app/modules/mail/create.html",controller:"Mail",access:{restricted:!0}}).when("/dashboard/apps/mails/:id/view",{templateUrl:"public/app/modules/mail/view.html",controller:"Mail",access:{restricted:!0}})}t.$inject=["$routeProvider"],angular.module("mail",["ngFileUpload","ngMessages"]).config(t)}(),function(){function t(t){t.when("/events",{controller:"Promotion",controllerAs:"vm",templateUrl:"public/app/modules/promotion/promotion.html"})}t.$inject=["$routeProvider"],angular.module("promotion",[]).config(t)}(),function(){function t(t){t.when("/vacancies",{controller:"Vacancy",controllerAs:"vm",templateUrl:"public/app/modules/vacancy/vacancy-list.html",access:{restricted:!1}}).when("/vacancies/:slug",{controller:"Vacancy",controllerAs:"vm",templateUrl:"public/app/modules/vacancy/vacancy.html",access:{restricted:!1}})}t.$inject=["$routeProvider"],angular.module("vacancy",[]).config(t)}(),function(){"use strict";function t(){function t(){}t()}angular.module("dashboard").controller("Dashboard",t)}(),function(){"use strict";function t(t,e,n){function r(){o(5)}function o(t){n.getEmployeesByDepartment(t).then(function(t){i.employees=t})["catch"](function(t){i.employees=[]})}function c(){i.query&&i.query.length>2?n.search(i.query).then(function(t){i.employees=t})["catch"](function(t){i.employees=o(5)}):i.employees=o(5)}var i=this;i.search=c,i.getEmployees=o,r(),n.getDepartments().then(function(t){i.departments=t})}angular.module("directory").controller("Directory",t),t.$inject=["$http","$routeParams","directoryService"]}(),function(){function t(t,e,n){function r(){n.getTickets({fname:"Courtney",lname:"Laidlaw"}).then(function(t){s.tickets=t})["catch"](function(t){s.tickets=[]})}function o(t){t&&(s.issue.category=s.selected.id,s.issue={},s.message=!0,r())}function c(){s.message=!1}function i(t){switch(t){case"open-tickets":r(),s.open_tickets=!0,s.create_ticket=!1,s.closed_tickets=!1;break;case"create-ticket":a(),s.create_ticket=!0,s.open_tickets=!1,s.closed_tickets=!1;break;case"closed-tickets":s.open_tickets=!1,s.create_ticket=!1,s.closed_tickets=!0}}function a(){n.getCategories().then(function(t){s.selected=t[0],s.categories=t})["catch"](function(t){s.categories=[]})}function u(){n.getClosedTickets({fname:"Courtney",lname:"Laidlaw"}).then(function(t){s.tickets_closed=t})["catch"](function(t){s.tickets_closed=[]})}var s=this;s.open_tickets=!0,s.closed_tickets=!1,s.create_ticket=!1,s.message=!1,s.dismiss=c,s.toggle=i,s.handleForm=o,s.issue={},r(),u()}angular.module("help").controller("HelpDesk",t),t.$inject=["$scope","$http","helpDeskService"]}(),function(){"use strict";function t(t,e,n,r,o,c){function i(t){e.path("#/"+t)}function a(){c.goTo("blogs")}function u(){c.goTo("staff-focus")}function u(){o.getPostsByCategory("staff-focus").then(function(t){s.staff=t})["catch"](function(t){s.staff=[]})}var s=this;s.goTo=i,s.getBlogs=a,s.getStaffFocus=u}angular.module("home").controller("Home",t),t.$inject=["$http","$location","$window","$routeParams","homeService","sharedServices"]}(),function(){function t(t,e){function n(n){e.checkCredentials(n)?e.authUser(n).then(function(n){n.success?e.getDepartment(n.dn).then(function(r){e.getUser(n.dn,r.id).then(function(n){n.success&&(o.user={},e.setUser(n.user),t.path("/dashboard/apps"))})["catch"](function(t){console.log("Error in getting user")})})["catch"](function(t){console.log("Error in getting department")}):(o.message=!0,o.user.password="")})["catch"](function(t){console.log(t)}):(o.message=!0,o.user.password="")}function r(){e.isAuthenticated()&&t.path("/dashboard/apps")}var o=this;o.handleForm=n,o.message=!1,o.user={name:"",password:""},r()}angular.module("login").controller("Login",t),t.$inject=["$location","loginService"]}(),function(){"use strict";function t(t){function e(){console.log("Nav")}function n(){console.log("Logout")}t.logout=n,e()}angular.module("nav").controller("Nav",t),t.$inject=["$scope"]}(),function(){function t(t,e,n,r,o,c,i){function a(){n.file=[],n.mail=angular.copy(w),n.mailForm.$setPristine(),n.mailForm.$setValidity(),n.mailForm.$setUntouched()}function u(t){r.getMail(t).then(function(r){n.mail_corr=r.mail,n.uploads=r.uploads,n.actions=r.actions,e.path("/mails/"+t+"/view")})["catch"](function(t){n.mail={}})}function s(){var t=o.getDepartmentId();r.getMailsByDepartmentId(t).then(function(t){n.mails=t})["catch"](function(t){n.mails=[]})}function l(t){e.path("/"+t)}function f(){r.createMail(n.mail).then(function(t){500===t.status&&(n.message=!0,n.text="An error has occurred on the server",n.error=!0),400===t.status&&(n.message=!0,n.text="Please review the form for errors",n.error=!0),200===t.status&&(n.message=!0,n.text="Mail correspondence created successfully",n.success=!0,a(),s())})["catch"](function(t){console.log("Error in creating mail")})}function d(){n.file=[]}function m(t){switch(t){case"other":n.showOther=!0,n.showFile=!1;break;case"file":n.showFile=!0,n.showOther=!1;break;default:n.showOther=!1,n.showFile=!1}}function h(){n.revealAction=!n.revealAction}function p(){n.revealAction=!1,n.description=""}function g(t){var e={mail_id:n.mail_corr.id,uid:o.getUserId(),description:n.description};r.createAction(e).then(function(t){p(),v(n.mail_corr.id)})["catch"](function(t){})}function v(t){r.getActions(t).then(function(t){n.actions=t})["catch"](function(t){n.actions=[]})}function y(){if(n.file&&n.file.length>0){var t=n.file[0];c.base_url+"upload/"+n.mail_corr.id;r.uploadFile(t,n.mail_corr.id).then(function(t){d(),_(),v(n.mail_corr.id)})}}function _(){var t=n.mail_corr.id;r.getAttachments(t).then(function(t){n.uploads=t})["catch"](function(t){console.log("Error in getting attachments")})}function $(){o.logout(),e.path("/login")}function b(){r.updateMail(n.mail_corr).then(function(t){n.message=!0,u(n.mail_corr.id)})["catch"](function(t){console.log("Error in updating mail")})}n.message=!1,n.error=!1,n.text="",n.showOther=!1,n.file_upload_msg=!1,n.revealAction=!1,n.mail=r.initMail();var w=angular.copy(n.mail);n.showMail=u,n.goTo=l,n.createMail=f,n.removeFile=d,n.clearForm=a,n.createMail=f,n.toggle=m,n.root=c.root,n.createAction=g,n.revealActionForm=h,n.cancel=p,n.uploadFile=y,n.file=[],n.logout=$,n.update=b,s(),t.id&&u(t.id)}angular.module("mail").controller("Mail",t),t.$inject=["$routeParams","$location","$scope","mailService","loginService","API_URLS","Upload"]}(),function(){function t(t){function e(){t.getPostsByCategory("promos").then(function(t){n.promo=t})["catch"](function(t){n.promo=[]})}var n=this;e()}angular.module("promotion").controller("Promotion",t),t.$inject=["sharedServices"]}(),function(){function t(t,e){function n(t){e.goTo(t)}function r(){e.getPostsByCategory("vacancies").then(function(t){o.vacancies=t})["catch"](function(t){o.vacancies=[]})}var o=this;o.goTo=n,r(),e.getPostBySlug(t.slug).then(function(t){o.vacancy=t})}angular.module("vacancy").controller("Vacancy",t),t.$inject=["$routeParams","sharedServices"]}(),function(){"use strict";function t(){var t={};return t}angular.module("dashboard").service("dashboardService",t)}(),function(){"use strict";function t(t){function e(){function e(t){return t.data}function n(t){return t}var r="/intranet/api/v1/departments";return t.get(r).then(e)["catch"](n)}function n(e){function n(t){return t.data}function r(t){return t}var o="/intranet/api/v1/departments/"+e+"/employees";return t.get(o).then(n)["catch"](r)}function r(e){function n(t){return t.data}function r(t){return t}var o="/intranet/api/v1/employees/search?q="+e;return t.get(o).then(n)["catch"](r)}var o={getDepartments:e,getEmployeesByDepartment:n,search:r};return o}angular.module("directory").factory("directoryService",t),t.$inject=["$http"]}(),function(){function t(t){function e(e){function n(t){return t.data}function r(t){return t}return t.post("/api/v1/tickets",e).then(n)["catch"](r)}function n(e){function n(t){return t.data}function r(t){return t}return t.get("/api/v1/tickets/"+e.fname+"/"+e.lname).then(n)["catch"](r)}function r(e){function n(t){return t.data}function r(t){return t}return t.get("/api/v1/tickets/"+e.fname+"/"+e.lname+"/closed").then(n)["catch"](r)}function o(){function e(t){return t.data}function n(t){return t}return t.get("/api/v1/admin/tickets/types").then(e)["catch"](n)}var c={createTicket:e,getTickets:n,getClosedTickets:r,getCategories:o};return c}angular.module("help").factory("helpDeskService",t),t.$inject=["$http"]}(),function(){function t(t){function e(){function e(t){return t.data.posts}function n(t){return t}return t.get(c+"/get_category_posts?slug=vacancies").then(e)["catch"](n)}function n(e){function n(t){return t.data.post}function r(t){return t}return t.get(c+"/get_post/?slug="+e).then(n)["catch"](r)}function r(e){function n(t){return t.data.posts}function r(t){return t}return t.get(c+"/get_category_posts?slug="+e).then(n)["catch"](r)}function o(){function e(t){return t.data.items}function n(t){return t}return t.get("http://rss2json.com/api.json?rss_url=http://jamaica-gleaner.com/feed/rss.xml").then(e)["catch"](n)}var c="/wordpress/api",i={getVacancies:e,getVacancyBySlug:n,getPostsByCategory:r,getRSSFeed:o};return i}angular.module("home").factory("homeService",t),t.$inject=["$http"]}(),function(){"use strict";function t(t){function e(){var e="http://rss2json.com/api.json?rss_url=",n="http://www.jamaicaobserver.com/rss/news/",r=e+encodeURI(n);t.get(r).then(function(t){console.log(t.data.items.slice(0,3)),$scope.news=t.data.items.slice(0,3)})}var n={getRss:e};return n}t.$inject=["$http"],angular.module("intranet").factory("rssService",t),t.inject=["$http"]}(),function(){function t(t,e){function n(n){function r(t){return t.data}function o(t){return t}return t.post(e.base_url+"auth",n).then(r)["catch"](o)}function r(t){return(""!==t.name||""!==t.password)&&(""!==t.name&&""!==t.password)}function o(n){function r(t){return t.data}function o(t){return t}return t.post(e.base_url+"departments",{dn:n}).then(r)["catch"](o)}function c(){var t=JSON.parse(localStorage.getItem("user"));return null!=t&&("object"==typeof t||void 0)}function i(t){localStorage.setItem("user",JSON.stringify(t))}function a(){return JSON.parse(localStorage.getItem("user"))}function u(){var t=JSON.parse(localStorage.getItem("user"));return t.id}function s(){var t=JSON.parse(localStorage.getItem("user"));return t.dept_id}function l(){localStorage.removeItem("user")}function f(){var t=JSON.parse(localStorage.getItem("user"));return t.uname}function a(n,r){function o(t){return t.data}function c(t){return t}return t.post(e.base_url+"users",{dn:n,dept_id:r}).then(o)["catch"](c)}var d={authUser:n,checkCredentials:r,isAuthenticated:c,getDepartmentId:s,getDepartment:o,getUserId:u,getUser:a,getUserName:f,logout:l,setUser:i};return d}angular.module("login").service("loginService",t),t.$inject=["$http","API_URLS"]}(),function(){function t(t,e,n,r){function o(t,n){var o=e.base_url+"upload/"+n;return r.upload({url:o,file:t}).then(function(t){return t})}function c(r){function o(t){return t}function c(t){return t}""!==r.file_title&&null!=r.file_title||(r.file_title="none"),"other"===r.mail_type&&(r.mail_type=r.other_type),"cabinet_sub"===r.mail_type&&(r.mail_type="cabinet sub"),r.created_by=n.getUserId(),r.dept_id=n.getDepartmentId();var i=e.base_url+"mails";return t.post(i,r).then(o)["catch"](c)}function i(){return{mail_type:"letter",sender:"",receipent:"",from_org:"",subject:"",receipt_date:new Date,file_title:""}}function a(n){function r(t){return t.data}function o(t){return t}var c=e.base_url+"mails/"+n;return t.get(c).then(r)["catch"](o)}function u(n){function r(t){return t.data}function o(t){return t}var c=e.base_url+"mails/departments/"+n;return t.get(c).then(r)["catch"](o)}function s(n){function r(t){return t.data}function o(t){return t}var c=e.base_url+"mails/"+n.mail_id+"/actions";return t.post(c,n).then(r)["catch"](o)}function l(n){function r(t){return t.data}function o(t){return t}var c=e.base_url+"mails/"+n+"/actions";return t.get(c).then(r)["catch"](o)}function f(n){function r(t){return t.data}function o(t){return t}var c=e.base_url+"mails/"+n+"/attachments";return t.get(c).then(r)["catch"](o)}function d(r){function o(t){return t.data}function c(t){return t}var i=e.base_url+"mails/"+r.id;return r.created_by=n.getUserId(),r.uname=n.getUserName(),t.put(i,r).then(o)["catch"](c)}var m={getMailsByDepartmentId:u,getMail:a,createMail:c,initMail:i,getActions:l,getAttachments:f,createAction:s,uploadFile:o,updateMail:d};return m}angular.module("mail").service("mailService",t),t.$inject=["$http","API_URLS","loginService","Upload"]}(),function(){"use strict";function t(t,e){function n(t){e.path("/"+t)}function r(){function e(t){return t.data}function n(t){return t}return t.get("/api/v1/auth/user").then(e)["catch"](n)}function o(e){function n(t){return t.data.posts}function r(t){return t}return t.get(a+"/get_category_posts?slug="+e).then(n)["catch"](r)}function c(e){function n(t){return t.data.post}function r(t){return t}return t.get(a+"/get_post?id="+e).then(n)["catch"](r)}function i(e){function n(t){return t.data.post}function r(t){return t}return t.get(a+"/get_post/?slug="+e).then(n)["catch"](r)}var a="/wordpress/api",u={goTo:n,getPostBySlug:i,getPostsByCategory:o,getPostById:c,isAuth:r};return u}angular.module("shared-services",[]).factory("sharedServices",t),t.$inject=["$http","$location"]}();